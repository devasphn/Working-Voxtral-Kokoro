# Voxtral Model Configuration - VAD + ASR + LLM
# Optimized for real-time speech processing

server:
  host: "0.0.0.0"
  http_port: 8000
  health_port: 8005
  tcp_ports: []

model:
  name: "mistralai/Voxtral-Mini-3B-2507"
  cache_dir: "./model_cache"
  device: "cuda"
  torch_dtype: "bfloat16"
  max_memory_per_gpu: "16GB"   # OPTIMIZED: Increased from 8GB for better performance
  ultra_fast_mode: true
  warmup_enabled: true
  use_cache: true              # PHASE 3 OPTIMIZATION: Enable KV cache for faster generation

audio:
  sample_rate: 16000
  chunk_size: 1024
  format: "float32"
  channels: 1
  frame_duration_ms: 20

# Voice Activity Detection (VAD) - PHASE 3 OPTIMIZED for <100ms latency
vad:
  threshold: 0.01              # OPTIMIZED: Increased from 0.005 for faster detection
  min_voice_duration_ms: 100   # OPTIMIZED: Reduced from 200 for faster response
  min_silence_duration_ms: 200 # OPTIMIZED: Reduced from 400 for faster cutoff
  chunk_size_ms: 20
  overlap_ms: 2
  sensitivity: "high"          # Keep high for accuracy

spectrogram:
  n_mels: 32        # PHASE 3 OPTIMIZATION: Reduced from 64 for faster computation
  hop_length: 80    # PHASE 3 OPTIMIZATION: Reduced from 160 for faster processing
  win_length: 256   # PHASE 3 OPTIMIZATION: Reduced from 320 to match n_fft
  n_fft: 256        # PHASE 3 OPTIMIZATION: Reduced from 512 for faster FFT

streaming:
  enabled: true
  chunk_mode: "sentence_streaming"
  max_connections: 50
  buffer_size: 1024
  timeout_seconds: 300
  latency_target_ms: 50

# Chunked Response Configuration
chunked_response:
  enabled: true
  min_words_per_chunk: 2
  max_words_per_chunk: 8
  chunk_timeout_ms: 200
  separator_phrases: [". ", "? ", "! ", ", ", " and ", " but ", " so "]

# Performance Monitoring
performance:
  enable_monitoring: true
  log_detailed_metrics: false
  latency_warning_threshold_ms: 500
  memory_monitoring: false # DISABLED: Reduce overhead

logging:
  level: "WARNING" # REDUCED: Less logging overhead (was INFO)
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "./logs/voxtral_streaming.log"
